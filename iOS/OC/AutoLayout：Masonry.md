åœ¨å†™Masonryä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆæ¥èŠèŠçº¦æŸçš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä¸€ä¸ªViewçš„çº¦æŸéœ€è¦ç¡®å®šçš„æ˜¯ä¸¤ä¸ªå› ç´ ï¼Œä¸€ä¸ªæ˜¯å®½é«˜ä¿¡æ¯ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ä½ç½®ä¿¡æ¯ã€‚ åªæœ‰ç¡®å®šè¿™ä¸¤ä¸ªå› ç´ æ‰èƒ½çœŸæ­£çš„ç¡®å®šä¸€ä¸ªViewçš„çº¦æŸï¼Œå¦åˆ™çº¦æŸä¼šçˆ†è­¦å‘Šã€‚ä¸ç®¡ä½ æ€ä¹ˆåŠ çº¦æŸï¼Œå…¶å®æœ€åå½’æ ¹åˆ°åº•éƒ½æ˜¯ç¡®å®çš„è¿™ä¸¤ä¸ªä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬äº†è§£è¿™ä¸ªæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡çº¦æŸè½¬åŒ–æ¥äº†è§£æˆ‘ä»¬å¤šæ·»åŠ äº†çº¦æŸï¼Œæ˜¯å¦ç¼ºå¤±äº†æŸä¸ªçº¦æŸï¼Œè¿™ç§æ€æƒ³å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€ŸæŸ¥è¯¢é—®é¢˜æ‰€åœ¨ã€‚

ä½†æ˜¯æœ‰å¾ˆå¤šç«¥é‹ä¼šå‘ç°åœ¨ä½¿ç”¨ Masonry çš„æ—¶å€™ï¼Œå¦‚æœæ§ä»¶æ˜¯UILabelï¼ŒUIImageViewï¼ŒUIButtonç­‰è¿™äº›ç»„ä»¶åŠæŸäº›åŒ…å«å®ƒä»¬çš„ç³»ç»Ÿç»„ä»¶åªéœ€è¦æŒ‡å®šæ§ä»¶çš„ä½ç½®çº¦æŸï¼Œæ ¹æœ¬ä¸éœ€è¦æŒ‡å®šå®½é«˜çº¦æŸå³å¯å®Œæˆå¸ƒå±€ä»»åŠ¡ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºè¿™äº›æ§ä»¶ä¸­æœ‰ intrinsicContentSize è¿™ä¸ªå±æ€§ï¼ŒintrinsicContentSizeçš„ä½œç”¨å…¶å®å¾ˆç®€å•ï¼Œå®ƒä¼šè‡ªå·±æ ¹æ®å†…å®¹è®¡ç®—å‡ºæ§ä»¶çš„å›ºæœ‰å®½é«˜ï¼Œåœ¨å¸ƒå±€è¿‡ç¨‹å½“ä½ ä¸æŒ‡å®šå®½é«˜çº¦æŸçš„æ—¶å€™ï¼Œå®ƒå°±ä¼šç”Ÿæ•ˆã€‚å…·ä½“çš„å†…å®¹æˆ‘ä¼šåœ¨ä¸‹é¢è¯´åˆ°ã€‚è¿™é‡Œå°±ä¸è¿‡å¤šå™è¿°äº†ã€‚
é¦–å…ˆï¼ŒMasonryçš„æ·»åŠ å¸ƒå±€ä¸»è¦æœ‰ä¸‰ä¸ªï¼Œä¸‰ä¸ªæ–¹æ³•çš„ä½œç”¨åˆ†åˆ«æ˜¯åˆ›å»ºçº¦æŸï¼›æ›´æ–°æŸä¸ªçº¦æŸï¼Œå…¶ä»–çº¦æŸä¸å˜ï¼›ç§»é™¤å…ˆå‰æ‰€æœ‰çº¦æŸï¼Œæ·»åŠ æ–°åˆ°çš„çº¦æŸã€‚è¿™ä¸‰ä¸ªæ–¹æ³•æ ¹æ®åœºæ™¯éœ€è¦åˆç†ä½¿ç”¨ï¼Œå¦åˆ™å¯èƒ½é€ æˆå†…å­˜é—®é¢˜ï¼Œä¼˜åŒ–æ–¹å¼ä¸‹é¢æˆ‘ä»¬ä¼šæ¥èŠä¸€ä¸‹ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šå™è¿°äº†ã€‚
```java
- (NSArray *)mas_makeConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;

- (NSArray *)mas_updateConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;

- (NSArray *)mas_remakeConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;

```
å¦‚æœæˆ‘ä»¬æƒ³è®¾ç½®ä¸€ä¸ªå…·ä½“çš„æ•°å€¼è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¾‹å¦‚å®½åº¦æˆ‘ä»¬æƒ³è®¾ç½®æˆ10ä¸ªå•ä½ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¦‚ä¸‹è®¾ç½®ã€‚
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(@10);
}];

```

æˆ‘ä»¬å‘ç°ä¸Šé¢ä»£ç è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯Â **equalTo**Â è¿™ä¸ªå‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œè¿™å°±å¾ˆå°´å°¬äº†ï¼Œä¸ºå•¥ï¼Œä¹¦å†™å¤ªéº»çƒ¦ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Â **mas_equalTo**Â è¿™ä¸ªå‡½æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.mas_equalTo(10);
}];

```
ä¸Šé¢ä¹¦å†™çš„å¥½åƒä¹Ÿä¸æ˜¯ä¸€ä¸ªæœ€ä¼˜çš„æ–¹æ¡ˆï¼Œè™½ç„¶æˆ‘ä»¬è§£å†³äº†åé¢çš„é—®é¢˜ï¼Œä½†æ˜¯å‰é¢çš„ä»£ç å­—æ¯æ•°åˆå¤šäº†(æ‡’ç™Œå‘ä½œğŸ˜‚)ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„æ–‡ä»¶ä¹‹å‰åŠ ä¸Šä¸€ä¸ªÂ **#define MAS_SHORTHAND_GLOBALS**Â è¿™æ ·çš„[å®å®šä¹‰](https://so.csdn.net/so/search?q=%E5%AE%8F%E5%AE%9A%E4%B9%89&spm=1001.2101.3001.7020)ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨equalTo(10)äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
```c
#define MAS_SHORTHAND_GLOBALS

[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(10);
}];

```

å¦‚æœæˆ‘ä»¬æƒ³è¦è®¾ç½®subViewçš„å®½åº¦ç­‰äºçˆ¶è§†å›¾çš„å®½åº¦çš„50%ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¯¥æ€ä¹ˆç¼–å†™æˆ‘ä»¬çš„çº¦æŸå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨åˆ°Â **multipliedBy**Â å’ŒÂ **dividedBy**è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ä¹˜æ³•ï¼Œä¸€ä¸ªæ˜¯é™¤æ³•ï¼Œè¾ƒä¸ºç®€å•ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```c
//ä¹˜æ³•
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(self).multipliedBy(0.5);
}];
//é™¤æ³•
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(self).dividedBy(2);
}];

```
å¦‚æœæˆ‘ä»¬æƒ³è¦subViewçš„å®½åº¦ç­‰äºé«˜åº¦çš„2å€ï¼Œè¿™æ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦æŒ‡å®šequalTo()é‡Œé¢å…·ä½“çš„å€¼(å®é™…ä¸Šæ˜¯ä¼ ä¸€ä¸ª MASViewAttribute å¯¹è±¡)ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¼ ä¸€ä¸ªæ§ä»¶å¯¹è±¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(subView.mas_height).multipliedBy(2);
}];

```
æˆ‘ä»¬å°±ç®€å•å™è¿°ä¸€ä¸‹çº¦æŸä¼˜å…ˆçº§è®¾ç½®ï¼ŒMasonryä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªä¼˜å…ˆçº§çš„æ–¹æ³•ï¼ŒpriorityLow()ã€priorityMedium()ã€priorityHigh()ï¼Œè¿™ä¸‰ä¸ªæ–¹æ³•å†…éƒ¨å¯¹åº”ç€ä¸åŒçš„é»˜è®¤ä¼˜å…ˆçº§ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨priority() è®¾ç½®å…·ä½“çš„æ•°å€¼ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œå…³äºçº¦æŸä¼˜å…ˆçº§å…·ä½“ä½¿ç”¨ä¹Ÿä¼šåœ¨åé¢çš„æ¨¡å—ä¸­è¯´åˆ°ã€‚
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.width.equalTo(subView4).priorityLow();
   make.width.equalTo(@[subView2, subView3,@100]).priorityHigh();
   make.width.equalTo(@300).priority(888);
}];

```
å¦‚æœæˆ‘ä»¬æƒ³è®©subViewçš„å®½åº¦æ˜¯ çˆ¶è§†å›¾çš„å®½åº¦çš„30% + 10ä¸ªå•ä½é•¿åº¦ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¯¥æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿå…¶å®è¿™æ—¶å€™æœ‰ç‚¹ç±»ä¼¼äº CSS ä¸­çš„ calc() å‡½æ•°ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½è®¾ç½®ä¸¤æ¡çº¦æŸæ¡ä»¶ï¼Œå¦‚æœé‚£æ ·è®¾ç½®äº†ï¼Œåé¢çš„çº¦æŸæ¡ä»¶å°±ä¼šæŠŠå‰é¢çš„çº¦æŸæ¡ä»¶ç»™è¦†ç›–æ‰ï¼Œå¯¹æ­¤æˆ‘ä»¬å¦‚ä¸‹è®¾ç½®å³å¯ã€‚(offsetæ–¹æ³•å’ŒmultipliedByæ–¹æ³•é¡ºåºæ— å½±å“)
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
  make.width.equalTo(self).offset(10).multipliedBy(0.3);
}];

```

## çº¦æŸä¼˜å…ˆçº§ ä»¥åŠ intrinsicContentSizeç›¸å…³é—®é¢˜
çº¦æŸä¼˜å…ˆçº§ä»¥åŠintrinsicContentSizeçš„ç›¸å…³é—®é¢˜æ˜¯æˆ‘ä»¬ä¸å¾—ä¸æåˆ°çš„é—®é¢˜.

é¦–å…ˆæ¥è¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦æœ‰çº¦æŸä¼˜å…ˆçº§,æˆ‘ä»¬ç»™å®šä¸€ä¸ªåœºæ™¯,å‡è®¾æˆ‘ä»¬è®¾ç½®åœ¨ä¸€ä¸ªsuperView(å®½åº¦ä¸º 200)ä¸­çš„ä¸€ä¸ªViewå­è§†å›¾çš„å·¦å³è¾¹è·éƒ½ä¸º0,ç„¶åç¬¬äºŒä¸ªçº¦æŸæ˜¯è§†å›¾çš„å®½åº¦ä¸º100,è¿™æ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜,å› ä¸ºå¦‚æœå·¦å³è¾¹è·éƒ½ä¸º0,é‚£ä¹ˆè§†å›¾å®½åº¦ä¸º200,è¿™æ ·å’Œç¬¬äºŒä¸ªçº¦æŸæ¡ä»¶å°±å‘ç”Ÿäº†å†²çª,ç³»ç»Ÿæ˜¯ä¸å…è®¸è¿™æ ·çš„é—®é¢˜å‡ºç°çš„.é‚£ä¹ˆæˆ‘ä»¬æƒ³ä¸åœ¨åˆ é™¤çº¦æŸçš„æƒ…å†µä¸‹,è¯¥å¦‚ä½•è§£å†³è¿™ç§é—®é¢˜å‘¢?è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦é€šè¿‡è®¾ç½®çº¦æŸä¼˜å…ˆçº§æ¥è§£å†³è¿™ä¸€ç±»é—®é¢˜,ç³»ç»Ÿé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªâ€ç›¸äº’å†²çªçš„çº¦æŸâ€çš„ä¼˜å…ˆçº§ï¼Œä»è€Œå¿½ç•¥ä½ä¼˜å…ˆçº§çš„æŸä¸ªçº¦æŸï¼Œè¾¾åˆ°æ­£ç¡®å¸ƒå±€çš„ç›®çš„çº¦æŸä¼˜å…ˆçº§é»˜è®¤éƒ½æ˜¯1000.æ‰€ä»¥æˆ‘ä»¬ç»™è®¾å®šä¸€ä¸ªæ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®ä¸€ä¸ªåˆé€‚çš„å€¼å³å¯,ä»£ç å¦‚ä¸‹æ‰€ç¤º.
```c
[subView mas_makeConstraints:^(MASConstraintMaker *make) {
   make.left.right.equalTo(self);
   make.width.equalTo(@100).priority(888);
}];

```
çº¦æŸä¼˜å…ˆçº§ä¸»è¦æ˜¯åº”å¯¹ä¸å•ä¸ªè§†å›¾ä¸­å¤šä¸ªçº¦æŸå‘ç”Ÿå†²çªçš„æ—¶å€™è§£å†³é—®é¢˜çš„æ–¹æ¡ˆ.è€Œ intrinsicContentSize ä¸»è¦åº”å¯¹äºå¤šä¸ªè§†å›¾çº¦æŸå‘ç”Ÿå†²çªçš„è§£å†³æ–¹æ¡ˆ,æˆ‘ä»¬å°±å¯¹ç€å…·ä½“çš„å®ä¾‹æ¥è¿›è¡Œåˆ†æ.

åœ¨æœ€å‰é¢æˆ‘ä»¬è¯´åˆ° åœ¨AutoLayoutä¸­ï¼Œ intrinsicContentSizeçš„ä½œç”¨å…¶å®å¾ˆç®€å•ï¼Œå®ƒä¼šè‡ªå·±æ ¹æ®å†…å®¹è®¡ç®—å‡ºæ§ä»¶çš„å›ºæœ‰å®½é«˜ï¼Œåœ¨å¸ƒå±€è¿‡ç¨‹å½“ä½ ä¸æŒ‡å®šå®½é«˜çº¦æŸçš„æ—¶å€™ï¼Œå®ƒå°±ä¼šç”Ÿæ•ˆã€‚

è¿™ä¸ªå±æ€§æ˜¯éå¸¸çš„å¥½ç”¨,ä½†æ˜¯ä¹Ÿä¼šå‡ºç°å¯¹åº”çš„é—®é¢˜.ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªLabel,ä¸¤ä¸ªLableçš„çº¦æŸæ¡ä»¶å¦‚ä¸‹æ‰€ç¤º.
```c
[label1 mas_makeConstraints:^(MASConstraintMaker *make) {
   make.left.equalTo(superView);
   make.top.equalTo(superView);
}];

[label2 mas_makeConstraints:^(MASConstraintMaker *make) {
   make.left.equalTo(label1.mas_right);
   make.top.equalTo(superView);
}];

```
ä¸Šé¢çš„æƒ…å†µå®Œå…¨æ²¡æœ‰ä»»ä½•çš„é—®é¢˜,å› ä¸º intrinsicContentSize å±æ€§çš„åŸå› ,æˆ‘ä»¬è½»æ¾å®Œæˆå¸ƒå±€ä»»åŠ¡,ä½†æ˜¯å½“æˆ‘ä»¬ç»™ label2 æ·»åŠ ä¸€ä¸ª å³è¾¹è·ç­‰äºsuperView.ä»£ç å¦‚ä¸‹æ‰€ç¤º.
```c
[label2 mas_makeConstraints:^(MASConstraintMaker *make) {
   make.left.equalTo(label1.mas_right);
   make.right.equalTo(superView);
   make.top.equalTo(superView);
}];
```
è¿™æ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜,label1 å’Œ label2 å¿…ç„¶æœ‰ä¸€ä¸ªä¸èƒ½æ»¡è¶³ intrinsicContentSize çº¦æŸæ¡ä»¶,å¿…ç„¶æœ‰ä¸€ä¸ªéœ€è¦æ‹‰ä¼¸æ‰èƒ½å®Œæˆçº¦æŸå¸ƒå±€ä»»åŠ¡,æˆ‘ä»¬ç§°è¿™ç§é—®é¢˜å«åš Intrinsicå†²çª.

è§£å†³ Intrinsicå†²çª ä¸€å…±æœ‰ä¸¤ç§æ–¹æ¡ˆ,ä¸€ç§æ˜¯ç›´æ¥æŒ‡å®šå†²çªçš„label 1 å’Œ label 2çš„å®½é«˜çº¦æŸä¿¡æ¯.ç¬¬äºŒç§å°±æ˜¯åˆ©ç”¨ content Huggingï¼content Compression Resistance.åŸå§‹æ–¹æ³•å¦‚ä¸‹æ‰€ç¤º.
```c
- (void)setContentHuggingPriority:(UILayoutPriority)priority forAxis:(UILayoutConstraintAxis)axis API_AVAILABLE(ios(6.0));
- (void)setContentCompressionResistancePriority:(UILayoutPriority)priority forAxis:(UILayoutConstraintAxis)axis API_AVAILABLE(ios(6.0));

```
Content Hugging çº¦æŸï¼ˆä¸æƒ³å˜å¤§çº¦æŸï¼‰è¡¨ç¤ºï¼šå¦‚æœç»„ä»¶çš„æ­¤å±æ€§ä¼˜å…ˆçº§æ¯”å¦ä¸€ä¸ªç»„ä»¶æ­¤å±æ€§ä¼˜å…ˆçº§é«˜çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¿æŒä¸å˜ï¼Œå¦ä¸€ä¸ªå¯ä»¥åœ¨éœ€è¦æ‹‰ä¼¸çš„æ—¶å€™æ‹‰ä¼¸ã€‚å±æ€§åˆ†æ¨ªå‘å’Œçºµå‘2ä¸ªæ–¹å‘ã€‚

Content Compression Resistance çº¦æŸï¼ˆä¸æƒ³å˜å°çº¦æŸï¼‰è¡¨ç¤ºï¼šå¦‚æœç»„ä»¶çš„æ­¤å±æ€§ä¼˜å…ˆçº§æ¯”å¦ä¸€ä¸ªç»„ä»¶æ­¤å±æ€§ä¼˜å…ˆçº§é«˜çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¿æŒä¸å˜ï¼Œå¦ä¸€ä¸ªå¯ä»¥åœ¨éœ€è¦å‹ç¼©çš„æ—¶å€™å‹ç¼©ã€‚å±æ€§åˆ†æ¨ªå‘å’Œçºµå‘2ä¸ªæ–¹å‘ã€‚ æ„æ€å¾ˆæ˜æ˜¾ã€‚ä¸Šé¢UIlabelè¿™ä¸ªä¾‹å­ä¸­ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæŸä¸ªUILabelä½¿ç”¨Intrinsic Content Sizeçš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªéœ€è¦æ‹‰ä¼¸ã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦è°ƒæ•´ä¸¤ä¸ªUILabelçš„ Content Huggingçº¦æŸçš„ä¼˜å…ˆçº§å°±å¯ä»¥å•¦ã€‚
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®è¿™ä¸¤ä¸ªæ–¹æ³•æ¥è§£å†³Â **Intrinsicå†²çª**Â é—®é¢˜,å‡è®¾ æˆ‘ä»¬æƒ³è®© label 2 æ‹‰ä¼¸,label1å°½é‡ä¸æ‹‰ä¼¸,æˆ‘ä»¬å°±å¯ä»¥è®¾ç½®å¦‚ä¸‹ä»£ç .å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤º.
```c
[label1  setContentHuggingPriority:UILayoutPriorityRequired forAxis:UILayoutConstraintAxisHorizontal];
[label2  setContentHuggingPriority:UILayoutPriorityDefaultLow forAxis:UILayoutConstraintAxisHorizontal];

```
# Masonry:iOS12
æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå…¶å®Masonryæ˜¯å°è£…ç³»ç»Ÿçš„NSLayoutConstraints,ç®€åŒ–äº†ä»£ç ï¼Œä½†æ˜¯åœ¨iOS12ä¹‹å‰NSLayoutConstraintså­˜åœ¨ç€è‡´å‘½çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯æ€§èƒ½é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªåœ¨iOS12ä¹‹åä¹Ÿä¼šå­˜åœ¨åªæ˜¯å°äº†å¾ˆå¤šã€‚é‚£ä¹ˆåœ¨iOS12ä¹‹å‰åˆ°åº•æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´è¿™äº›é—®é¢˜å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬é€ä¸€åˆ†æå„ç§æƒ…å†µã€‚

AutoLayoutä½¿ç”¨çš„å¸ƒå±€ç®—æ³•å…¶å®æ˜¯ Cassowaryï¼Œåœ¨WWDC2018ï¼Œå®˜æ–¹å¯¹å…¶æ€§èƒ½é—®é¢˜æå‡ºäº†è¯´æ˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°iOS12å‰çš„AutoLayoutå¸ƒå±€æ€§èƒ½æ˜¯æˆæŒ‡æ•°æ€§å¢é•¿çš„ã€‚
![[Pasted image 20230507163808.png]]
ä½†æ˜¯ä¸æ˜¯æ‰€æœ‰çš„å¸ƒå±€éƒ½æœ‰è¿™æ ·çš„é—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯å¦å®šçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ‰€ä»¥è¯´AutoLayoutåªæ˜¯åœ¨æŸäº›æƒ…å†µå­˜åœ¨ç€é—®é¢˜ã€‚
![[Pasted image 20230507163843.png]]
é‚£ä¹ˆçœŸæ­£çš„åŸå§‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºiOS12ä¹‹å‰ï¼Œå½“æœ‰çº¦æŸå˜åŒ–æ—¶éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªè®¡ç®—å¼•æ“ NSISEngier å°†çº¦æŸå…³ç³»é‡æ–°åŠ èµ·æ¥ï¼Œé‡æ–°è®¡ç®—ã€‚æ¶‰åŠåˆ°çº¦æŸå…³ç³»å˜å¤šæ—¶ï¼Œæ–°çš„è®¡ç®—å¼•æ“éœ€è¦é‡æ–°è®¡ç®—ï¼Œæœ€ç»ˆå¯¼è‡´è®¡ç®—é‡æŒ‡æ•°çº§å¢åŠ ã€‚

iOS12çš„AutoLayoutæ›´å¤šçš„åˆ©ç”¨äº†Cassowaryç®—æ³•çš„ç•Œé¢æ›´æ–°ç­–ç•¥ï¼Œä½¿å…¶çœŸæ­£å®Œæˆäº†é«˜æ•ˆçš„ç•Œé¢çº¿æ€§ç­–ç•¥è®¡ç®—ã€‚ä½¿å…¶å°½é‡æˆçº¿ç¨‹å¢åŠ ï¼Œå‡å°‘æ€§èƒ½é—®é¢˜ï¼Œæœ€åå…è®¸æˆ‘å” å¨ä¸€å¥ï¼Œè®²çœŸçš„ï¼Œæ€§èƒ½å†å¼ºä¹Ÿæ˜¯å¹²ä¸è¿‡Frameå¸ƒå±€æ–¹å¼çš„ï¼Œä½†æ˜¯èƒœåœ¨ç®€å•æ–¹ä¾¿ã€‚
# Masonryæºç è§£æ
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/8211735c83604e79ae32da6a3adfed53.png#pic_center)

Masonry ä¸»è¦æ–¹æ³•ç”±ä¸Šè¿°ä¾‹å­å°±å¯ä¸€çª¥å…¨è²Œã€‚Masonryä¸»è¦é€šè¿‡å¯¹Â `UIView`ï¼ˆ`NSView`ï¼‰ã€`NSArray`ã€`UIViewController`Â è¿›è¡Œåˆ†ç±»æ‰©å±•ï¼Œä»è€Œæä¾›è‡ªåŠ¨å¸ƒå±€çš„æ„å»ºæ–¹æ³•ã€‚
å¯¹äºä¸€ä¸ªä¸€èˆ¬çš„å¸ƒå±€çº¦æŸï¼Œç ”ç©¶ä¸€ä¸‹çº¦æŸæ–¹æ³•
```c
Â Â  [_masParView mas_makeConstraints:^(MASConstraintMaker *make) {

Â  Â  Â  Â  make.edges.equalTo(self.view).with.insets(UIEdgeInsetsMake(100, 100, 100, 100));

Â  Â  }];
```
è°ƒç”¨çš„æ–¹æ³•æ˜¯`UIView`çš„åˆ†ç±»`MASAdditions`ä¸­çš„`mas_makeConstraints:`æ–¹æ³•
```c
/**
Â *Â  Creates a MASConstraintMaker with the callee view.
Â *Â  Any constraints defined are added to the view or the appropriate superview once the block has finished executing
Â *Â  **@param** block scope within which you can build up the constraints which you wish to apply to the view.
Â *Â  **@return** Array of created MASConstraints
Â *Â  ä½¿ç”¨è¢«è°ƒç”¨çš„è§†å›¾åˆ›å»ºä¸€ä¸ªMASConstraintMakerã€‚ä¸€æ—¦ä»£ç å—æ‰§è¡Œå®Œæ¯•ï¼Œä»»ä½•å®šä¹‰çš„çº¦æŸ
Â *Â  éƒ½ä¼šè¢«æ·»åŠ åˆ°è§†å›¾æˆ–é€‚å½“çš„çˆ¶è§†å›¾ä¸­
Â *Â  @å‚æ•° å—ä½œç”¨åŸŸï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ„å»ºæ‚¨å¸Œæœ›åº”ç”¨äºè§†å›¾çš„çº¦æŸã€‚
Â *Â  @è¿”å› åˆ›å»ºçš„MASConstraintsçš„æ•°ç»„
Â */

- (NSArray *)mas_makeConstraints:(**void**(NS_NOESCAPE ^)(MASConstraintMaker *make))block;
```
å®ç°
```c
- (NSArray *)mas_makeConstraints:(void(^)(MASConstraintMaker *))block {

Â  Â  self.translatesAutoresizingMaskIntoConstraints = NO;

Â  Â  MASConstraintMaker *constraintMaker = [[MASConstraintMaker alloc] initWithView:self];

Â  Â  block(constraintMaker);

Â  Â  return [constraintMaker install];

}
```
è¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª `MASConstraintMaker` å¯¹è±¡ï¼Œå¹¶å°†å½“å‰è§†å›¾ä½œä¸ºå…¶åˆå§‹åŒ–å‚æ•°ã€‚ç„¶åï¼Œè¯¥æ–¹æ³•å°†ä¼ å…¥çš„ `block` å—ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `MASConstraintMaker` å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•æ¥æè¿°è§†å›¾çš„çº¦æŸã€‚æœ€åï¼Œè¯¥æ–¹æ³•è°ƒç”¨ `install` æ–¹æ³•ï¼Œå°†çº¦æŸåº”ç”¨åˆ°å½“å‰è§†å›¾ä¸Šï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰çº¦æŸçš„æ•°ç»„ã€‚

é¦–å…ˆï¼Œè¯¥æ–¹æ³•å°† `translatesAutoresizingMaskIntoConstraints` å±æ€§è®¾ç½®ä¸º `NO`ï¼Œè¿™æ˜¯ä¸ºäº†ç¡®ä¿ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€çº¦æŸè€Œéé»˜è®¤çš„ frame å¸ƒå±€æ–¹å¼ã€‚

ç„¶åï¼Œè¯¥æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª `MASConstraintMaker` å¯¹è±¡ï¼Œå¹¶å°†å½“å‰è§†å›¾ä½œä¸ºå…¶åˆå§‹åŒ–å‚æ•°ã€‚æ¥ç€ï¼Œè¯¥æ–¹æ³•å°†ä¼ å…¥çš„ `block` å—ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `MASConstraintMaker` å¯¹è±¡ï¼Œä»è€Œæè¿°äº†è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ã€‚è¿™ä¸ª `block` å—å‚æ•°ä¸­çš„ `MASConstraintMaker` å¯¹è±¡åŒ…å«äº†å„ç§ç”¨äºæè¿°è§†å›¾çº¦æŸçš„æ–¹æ³•ã€‚åœ¨è°ƒç”¨ `block` å—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥æè¿°å½“å‰è§†å›¾ä¸å…¶å®ƒè§†å›¾ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ã€å°ºå¯¸ç­‰ä¿¡æ¯ã€‚

æœ€åï¼Œè¯¥æ–¹æ³•è°ƒç”¨ `install` æ–¹æ³•ï¼Œå°†çº¦æŸåº”ç”¨åˆ°å½“å‰è§†å›¾ä¸Šï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰çº¦æŸçš„æ•°ç»„ã€‚`install` æ–¹æ³•ä¼šæ ¹æ®ä¹‹å‰è®¾ç½®çš„çº¦æŸä¿¡æ¯è®¡ç®—å‡ºåˆé€‚çš„çº¦æŸï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç›¸åº”çš„è§†å›¾ä¸Šã€‚åœ¨è¿™ä¸ªæ–¹æ³•è¿”å›ä¹‹åï¼Œå½“å‰è§†å›¾å°±ä¼šæŒ‰ç…§ä¹‹å‰è®¾ç½®çš„çº¦æŸè¿›è¡Œè‡ªåŠ¨å¸ƒå±€ã€‚
```c
- (id)initWithView:(MAS_VIEW *)view {
    self = [super init];
    if (!self) return nil;
    
    self.view = view;
    self.constraints = NSMutableArray.new;
    
    return self;
}
```
è¯¥æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ª `MASConstraintMaker` å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ç”¨äºæè¿°è§†å›¾çº¦æŸçš„æ–¹æ³•ã€‚åœ¨ä½¿ç”¨ Masonry è‡ªåŠ¨å¸ƒå±€åº“æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª `MASConstraintMaker` å¯¹è±¡ï¼Œç„¶åä½¿ç”¨å…¶ä¸­çš„æ–¹æ³•æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œæœ€åè°ƒç”¨ `install` æ–¹æ³•å°†çº¦æŸåº”ç”¨åˆ°ç›¸åº”çš„è§†å›¾ä¸Šã€‚

åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè°ƒç”¨çˆ¶ç±» `NSObject` çš„ `init` æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œåˆ™ç›´æ¥è¿”å› `nil`ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†ä¼ å…¥çš„ `view` å‚æ•°ä¿å­˜åˆ° `self.view` å±æ€§ä¸­ã€‚è¿™ä¸ª `view` å‚æ•°æŒ‡çš„æ˜¯æˆ‘ä»¬éœ€è¦è®¾ç½®çº¦æŸçš„è§†å›¾å¯¹è±¡ã€‚

æˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ª `NSMutableArray` ç±»å‹çš„æ•°ç»„ï¼Œç”¨äºä¿å­˜åç»­æ·»åŠ çš„çº¦æŸã€‚æˆ‘ä»¬å°†è¿™ä¸ªæ•°ç»„ä¿å­˜åˆ° `self.constraints` å±æ€§ä¸­ã€‚

æœ€åï¼Œè¯¥æ–¹æ³•è¿”å›åˆå§‹åŒ–åçš„ `MASConstraintMaker` å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å„ç§ç”¨äºæè¿°è§†å›¾çº¦æŸçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¹‹åçš„ä»£ç ä¸­ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ã€‚


åœ¨ `mas_makeConstraints` æ–¹æ³•ä¸­ä¼ é€’çš„å—å‚æ•°æ˜¯ä¸€ä¸ª blockï¼Œè¿™ä¸ª block çš„å‚æ•°ç±»å‹æ˜¯ `MASConstraintMaker` å¯¹è±¡ï¼Œå³ä¸€ä¸ªç”¨äºæè¿°è§†å›¾çº¦æŸçš„å¯¹è±¡ã€‚åœ¨ block ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `MASConstraintMaker` å¯¹è±¡æä¾›çš„å„ç§æ–¹æ³•æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ã€‚

å…·ä½“æ¥è¯´ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ `mas_makeConstraints` æ–¹æ³•æ—¶ï¼ŒMasonry ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª `MASConstraintMaker` å¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªå¯¹è±¡ä½œä¸º block çš„å‚æ•°ä¼ é€’ç»™æˆ‘ä»¬ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ block ä¸­ä½¿ç”¨è¿™ä¸ª `MASConstraintMaker` å¯¹è±¡çš„å„ç§æ–¹æ³•æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œä¾‹å¦‚ï¼š


```c
[view1 mas_makeConstraints:^(MASConstraintMaker *make) {     
make.left.top.equalTo(superview).offset(10);     
make.right.bottom.equalTo(superview).offset(-10); 
}];
```


åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `make.left.top.equalTo(superview).offset(10)` å’Œ `make.right.bottom.equalTo(superview).offset(-10)` è¿™ä¸¤ä¸ªæ–¹æ³•æ¥æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ã€‚è¿™äº›æ–¹æ³•çš„ä½œç”¨æ˜¯å°† `view1` çš„å·¦ä¾§å’Œé¡¶éƒ¨ä¸ `superview` çš„å·¦ä¾§å’Œé¡¶éƒ¨å¯¹é½ï¼Œå¹¶å‘å³å’Œå‘ä¸‹åç§» 10 ä¸ªå•ä½ï¼ŒåŒæ—¶å°† `view1` çš„å³ä¾§å’Œåº•éƒ¨ä¸ `superview` çš„å³ä¾§å’Œåº•éƒ¨å¯¹é½ï¼Œå¹¶å‘å·¦å’Œå‘ä¸Šåç§» 10 ä¸ªå•ä½ã€‚

åœ¨ block ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `MASConstraintMaker` å¯¹è±¡çš„å„ç§æ–¹æ³•æ¥æè¿°è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œä¾‹å¦‚è®¾ç½®è§†å›¾çš„ä½ç½®ã€å¤§å°ã€é—´è·ç­‰ã€‚å½“ block æ‰§è¡Œå®Œæ¯•åï¼ŒMasonry ä¼šæ ¹æ®æˆ‘ä»¬åœ¨ block ä¸­æè¿°çš„çº¦æŸå…³ç³»æ¥è‡ªåŠ¨è®¡ç®—è§†å›¾çš„ä½ç½®å’Œå¤§å°ï¼Œå¹¶å°†è¿™äº›çº¦æŸå…³ç³»åº”ç”¨åˆ°ç›¸åº”çš„è§†å›¾ä¸Šï¼Œä»è€Œå®ç°è‡ªåŠ¨å¸ƒå±€ã€‚



## ä¸‹é¢æ˜¯ä½¿ç”¨`make.width`ç‚¹è¯­æ³•åçš„å…¨éƒ¨å†…éƒ¨è°ƒç”¨è¿‡ç¨‹ï¼š
```c
// MASConstraintMaker
- (MASConstraint *)width {
    return [self addConstraintWithLayoutAttribute:NSLayoutAttributeWidth];
}

- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {
    return [self constraint:nil addConstraintWithLayoutAttribute:layoutAttribute];
}

- (MASConstraint *)constraint:(MASConstraint *)constraint addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {
    // æ ¹æ® çº¦æŸå±æ€§ å’Œ è§†å›¾ åˆ›å»ºä¸€ä¸ªçº¦æŸå•å…ƒ
    MASViewAttribute *viewAttribute = [[MASViewAttribute alloc] initWithView:self.view layoutAttribute:layoutAttribute];
    //åˆ›å»ºçº¦æŸï¼Œä»¥çº¦æŸå•å…ƒä½œä¸ºçº¦æŸçš„ç¬¬ä¸€é¡¹
    MASViewConstraint *newConstraint = [[MASViewConstraint alloc] initWithFirstViewAttribute:viewAttribute];
    if ([constraint isKindOfClass:MASViewConstraint.class]) {
        //replace with composite constraint
        // å¦‚æœæ˜¯åœ¨å·²æœ‰çº¦æŸçš„åŸºç¡€ä¸Šå†åˆ›å»ºçš„çº¦æŸï¼Œåˆ™å°†å®ƒä»¬è½¬æ¢æˆä¸€ä¸ª ç»„åˆçº¦æŸï¼Œå¹¶å°†åŸçº¦æŸæ›¿æ¢æˆè¯¥ç»„åˆçº¦æŸã€‚
        NSArray *children = @[constraint, newConstraint];
        MASCompositeConstraint *compositeConstraint = [[MASCompositeConstraint alloc] initWithChildren:children];
        compositeConstraint.delegate = self;
        // è¿™é‡Œä¼šå°†åŸæ¥ make.width æ·»åŠ çš„çº¦æŸ æ›¿æ¢æˆä¸€ä¸ª ç»„åˆçº¦æŸï¼ˆå®½åº¦çº¦æŸ + é«˜åº¦çº¦æŸï¼‰
        [self constraint:constraint shouldBeReplacedWithConstraint:compositeConstraint];
        // è¿”å›ç»„åˆçº¦æŸ
        return compositeConstraint;
    }
    if (!constraint) {// å¦‚æœä¸æ˜¯åœ¨å·²æœ‰çº¦æŸçš„åŸºç¡€ä¸Šå†åˆ›å»ºçº¦æŸï¼Œåˆ™æ·»åŠ çº¦æŸè‡³åˆ—è¡¨
        newConstraint.delegate = self;// æ³¨æ„è¿™ä¸€æ­¥ï¼Œä¼šå¯¹ make.top.left è¿™ç§æƒ…å½¢äº§ç”Ÿå…³é”®å½±å“
        [self.constraints addObject:newConstraint];
    }
    return newConstraint;
}
```
åœ¨ç¬¬äºŒæ¬¡è®¾ç½®çº¦æŸæ—¶ï¼ˆ`.height`ï¼‰ä¼šè¿›å…¥ä¸åŒçš„æµç¨‹ã€‚æ³¨æ„ä¸Šé¢æåˆ°çš„`newConstraint.delegate`è®¾ç½®ä»£ç†ï¼š
```c
//MAConstraint
- (MASConstraint *)height {
    return [self addConstraintWithLayoutAttribute:NSLayoutAttributeHeight];
}
//MSViewConstraint
- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {
    NSAssert(!self.hasLayoutRelation, @"Attributes should be chained before defining the constraint relation");
	//delegateæ˜¯MASConstraintMaker
    return [self.delegate constraint:self addConstraintWithLayoutAttribute:layoutAttribute];
}
// MASConstraintMaker
- (MASConstraint *)constraint:(MASConstraint *)constraint addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {...}

```
ä¸‹é¢çœ‹ä¸€ä¸‹`.mas_equalTo(@100)`çš„æµç¨‹ã€‚
```c
// MASConstraint
#define mas_equalTo(...)                 equalTo(MASBoxValue((__VA_ARGS__)))
- (MASConstraint * (^)(id))equalTo {
    return ^id(id attribute) {
        // attribute å¯èƒ½æ˜¯ @100 ç±»ä¼¼çš„å€¼ï¼Œä¹Ÿå¯èƒ½æ˜¯ view.mas_widthç­‰è¿™æ ·çš„
        return self.equalToWithRelation(attribute, NSLayoutRelationEqual);
    };
}
- (MASConstraint * (^)(id))mas_equalTo {
    return ^id(id attribute) {
        return self.equalToWithRelation(attribute, NSLayoutRelationEqual);
    };
}
// MASViewConstraint
- (MASConstraint * (^)(id, NSLayoutRelation))equalToWithRelation {
    return ^id(id attribute, NSLayoutRelation relation) {
        if ([attribute isKindOfClass:NSArray.class]) {//æ˜¯æ•°ç»„ï¼ˆæœ‰å¤šä¸ªçº¦æŸï¼‰
            NSAssert(!self.hasLayoutRelation, @"Redefinition of constraint relation");
            NSMutableArray *children = NSMutableArray.new;
            for (id attr in attribute) {
                MASViewConstraint *viewConstraint = [self copy];
                viewConstraint.layoutRelation = relation;
                viewConstraint.secondViewAttribute = attr;// è®¾ç½®çº¦æŸç¬¬äºŒé¡¹
                [children addObject:viewConstraint];
            }
            MASCompositeConstraint *compositeConstraint = [[MASCompositeConstraint alloc] initWithChildren:children];
            compositeConstraint.delegate = self.delegate;
            [self.delegate constraint:self shouldBeReplacedWithConstraint:compositeConstraint];
            return compositeConstraint;
        } else {//å•ä¸ªçº¦æŸ
            NSAssert(!self.hasLayoutRelation || self.layoutRelation == relation && [attribute isKindOfClass:NSValue.class], @"Redefinition of constraint relation");
            self.layoutRelation = relation;
            self.secondViewAttribute = attribute;// è®¾ç½®çº¦æŸç¬¬äºŒé¡¹
            return self;
        }
    };
}
// è®¾ç½®çº¦æŸç¬¬äºŒé¡¹
- (void)setSecondViewAttribute:(id)secondViewAttribute {
	//åˆ¤æ–­ç±»å‹
    if ([secondViewAttribute isKindOfClass:NSValue.class]) {
        [self setLayoutConstantWithValue:secondViewAttribute];
    } else if ([secondViewAttribute isKindOfClass:MAS_VIEW.class]) {
        _secondViewAttribute = [[MASViewAttribute alloc] initWithView:secondViewAttribute layoutAttribute:self.firstViewAttribute.layoutAttribute];
    } else if ([secondViewAttribute isKindOfClass:MASViewAttribute.class]) {
        _secondViewAttribute = secondViewAttribute;
    } else {
        NSAssert(NO, @"attempting to add unsupported attribute: %@", secondViewAttribute);
    }
}
// MASConstraint
- (void)setLayoutConstantWithValue:(NSValue *)value {
    if ([value isKindOfClass:NSNumber.class]) {
        self.offset = [(NSNumber *)value doubleValue];
    } else if (strcmp(value.objCType, @encode(CGPoint)) == 0) {
        CGPoint point;
        [value getValue:&point];
        self.centerOffset = point;
    } else if (strcmp(value.objCType, @encode(CGSize)) == 0) {
        CGSize size;
        [value getValue:&size];
        self.sizeOffset = size;
    } else if (strcmp(value.objCType, @encode(MASEdgeInsets)) == 0) {
        MASEdgeInsets insets;
        [value getValue:&insets];
        self.insets = insets;
    } else {
        NSAssert(NO, @"attempting to set layout constant with unsupported value: %@", value);
    }
}

// MASViewConstraint
- (void)setOffset:(CGFloat)offset {
    self.layoutConstant = offset;       // è®¾ç½®çº¦æŸå¸¸é‡
}
- (void)setSizeOffset:(CGSize)sizeOffset {
    NSLayoutAttribute layoutAttribute = self.firstViewAttribute.layoutAttribute;
    switch (layoutAttribute) {
        case NSLayoutAttributeWidth:
            self.layoutConstant = sizeOffset.width;
            break;
        case NSLayoutAttributeHeight:
            self.layoutConstant = sizeOffset.height;
            break;
        default:
            break;
    }
}
- (void)setCenterOffset:(CGPoint)centerOffset {
    NSLayoutAttribute layoutAttribute = self.firstViewAttribute.layoutAttribute;
    switch (layoutAttribute) {
        case NSLayoutAttributeCenterX:
            self.layoutConstant = centerOffset.x;
            break;
        case NSLayoutAttributeCenterY:
            self.layoutConstant = centerOffset.y;
            break;
        default:
            break;
    }
}
- (void)setInsets:(MASEdgeInsets)insets {
    NSLayoutAttribute layoutAttribute = self.firstViewAttribute.layoutAttribute;
    switch (layoutAttribute) {
        case NSLayoutAttributeLeft:
        case NSLayoutAttributeLeading:
            self.layoutConstant = insets.left;
            break;
        case NSLayoutAttributeTop:
            self.layoutConstant = insets.top;
            break;
        case NSLayoutAttributeBottom:
            self.layoutConstant = -insets.bottom;
            break;
        case NSLayoutAttributeRight:
        case NSLayoutAttributeTrailing:
            self.layoutConstant = -insets.right;
            break;
        default:
            break;
    }
}
```
å¦å¤–ï¼Œåé¢çš„Â `offset`Â æ–¹æ³•åšäº†ä¸€æ­¥é¢å¤–çš„æ“ä½œï¼š
```c
// MASConstraint
- (MASConstraint * (^)(CGFloat))offset {
    return ^id(CGFloat offset){
        self.offset = offset;
        return self;
    };
}
- (void)setOffset:(CGFloat)offset {
    self.layoutConstant = offset;
}

```

```c
- (NSArray *)mas_makeConstraints:(void(^)(MASConstraintMaker *make))block {

Â  Â  NSMutableArray *constraints = [NSMutableArray array];

Â  Â  for (MAS_VIEW *view in self) {

Â  Â  Â  Â  NSAssert([view isKindOfClass:[MAS_VIEW class]], @"All objects in the array must be views");

Â  Â  Â  Â  [constraints addObjectsFromArray:[view mas_makeConstraints:block]];

Â  Â  }

Â  Â  return constraints;

}
```
è¯¥æ–¹æ³•ç”¨äºä¸ºä¸€ä¸ªåŒ…å«å¤šä¸ªè§†å›¾çš„æ•°ç»„è®¾ç½®çº¦æŸã€‚å…·ä½“åœ°ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šéå†æ•°ç»„ä¸­çš„æ¯ä¸ªè§†å›¾ï¼Œå¹¶å¯¹æ¯ä¸ªè§†å›¾è°ƒç”¨å…¶è‡ªèº«çš„ `mas_makeConstraints` æ–¹æ³•ï¼Œå°†ä¼ å…¥çš„ `block` å—ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒã€‚

`block` å—å‚æ•°ä¸­çš„ `MASConstraintMaker` å¯¹è±¡åŒ…å«äº†å„ç§ç”¨äºæè¿°è§†å›¾çº¦æŸçš„æ–¹æ³•ã€‚åœ¨è°ƒç”¨ `mas_makeConstraints` æ–¹æ³•æ—¶ï¼Œä¼ å…¥çš„ `block` å—ä¸­å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥æè¿°è§†å›¾ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ã€å°ºå¯¸ç­‰ä¿¡æ¯ã€‚`mas_makeConstraints` æ–¹æ³•ä¼šæ ¹æ®è¿™äº›ä¿¡æ¯è®¡ç®—å‡ºåˆé€‚çš„çº¦æŸï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç›¸åº”çš„è§†å›¾ä¸Šã€‚

åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¸ºäº†éå†æ•°ç»„ä¸­çš„æ¯ä¸ªè§†å›¾å¹¶æ·»åŠ çº¦æŸï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `for-in` å¾ªç¯ã€‚å¯¹äºæ¯ä¸ªè§†å›¾ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ `NSAssert` å‡½æ•°æ¥æ–­è¨€å…¶æ˜¯å¦å±äº `MAS_VIEW` ç±»å‹ï¼Œå¦‚æœä¸æ˜¯åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä»¥ä¿è¯è¯¥æ•°ç»„åªåŒ…å«è§†å›¾å¯¹è±¡ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†è§†å›¾çš„ `mas_makeConstraints` æ–¹æ³•è¿”å›çš„çº¦æŸæ·»åŠ åˆ° `constraints` æ•°ç»„ä¸­ã€‚æœ€åï¼Œè¯¥æ–¹æ³•è¿”å› `constraints` æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº†ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªè§†å›¾è®¾ç½®çš„çº¦æŸã€‚